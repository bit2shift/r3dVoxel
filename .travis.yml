dist: xenial
services: docker
language: minimal

addons:
 apt:
  packages:
  - curl
  - jq

dependencies: &deps
- xorg-dev
- libvulkan-dev

env:
- secure: "jUwqGlgcaE7eyaoxLUEzc1q5QvA8BXdzmozsTbkQYmMPxVBAVxpwLGbfsimncynbSnGGVeyGESEQPYe59XnfTx39sCBzUPjizU3f64cbURLzIdvcVO18PZxZsBdSPkUa66d93nER3KNua+wn3SZjkdnhiZcidpGOVtSwhSCoULExEpoXeMbjhgvBB/9hbPr0/hyvclyJt9O+4esVvzF83rUpNViXHKwcDnPa8bXr0LSRchkXvRM9bj7UkrV7MCAkdKxR+yOaRbzO//dMUMN6EGDay/dywPlWjSdXv9626+20yI/SH2wMGujv3N1b3+9JBNX8eYRP1cdoQEjV9+6r+9MAMTnf+9dmMHfmNU9m9vD28iVB8MnIOsevPUYGcn4BIWSga9ziIH2C8s9FQ7cCqCXcx4zg8m05HT/cQ6jg3mZdhz3RdQamh+hRHqZ6hgtIbxC6VLM+5n80Idz3zLo1NX8AJHNRxgeOAZjSE4PpjlaQLVnCfngvHEtDFAW4QIgFOUQCfyQ4ynfAyO32dJXHsQO6kMPMQeOfajBDHZTcSV5DcXEwdc9vc6WuesUGkD7j95dguanvJalW79gBOre0bEEpBFbUwqlBRBG1lwCZq3L1hrV9Y7oHarWfaCgYMcUzUW4SzTUDwfr6k6TaUY40t7ZjWCcN3cSfYZ7fGlk9LpM="

matrix:
 include:
 - env:
   - COMPILER=clang
   - CXX=clang++-8
   - CC=clang-8
   - CXXFLAGS=-stdlib=libc++
   - LDLIBS=-lc++
 - env:
   - COMPILER=gcc
   - CXX=g++-8
   - CC=gcc-8

script:
- curl -IL -A bit2shift --oauth2-bearer "$TOKEN" "https://api.github.com/repos/bit2shift/docker-r3v-toolchain-$COMPILER/releases/latest"
- docker import $(curl -sL -A bit2shift --oauth2-bearer "$TOKEN" "https://api.github.com/repos/bit2shift/docker-r3v-toolchain-$COMPILER/releases/latest" | jq -r ".assets[0].browser_download_url")
